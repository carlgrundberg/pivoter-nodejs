<!DOCTYPE HTML>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Pivoter</title>
    <link rel="stylesheet" type="text/css" media="all" href="style.css">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://pivoter.menmo.se:1337/socket.io/socket.io.js"></script>

    <script type="text/javascript">
        var socket = io.connect('pivoter.menmo.se:1337');
        var status = null;
        socket.on('update', function(data) {
            $('#votes').html(data.voted);
            $('#voters').html(data.total);
            if(status != data.status) {
                switch(data.status) {
                    case 0:
                        showpage('start');
                        break;
                    case 1:
                        $('.button').removeClass('disabled active').live('click', function() {
                            $(".button").removeClass('active');
                            $(this).addClass('active');
                            socket.emit('vote', { value: $(this).html() });
                        });
                        showpage('vote');
                        break;
                    case 2:
                        $('.button').addClass('disabled').die();
                        showpage('vote');
                        break;
                }
                status = data.status;
            }
        });

        function showpage(page) {
            $('.page').hide();
            $('#'+page).show();
        }
    </script>
</head>
<body>
<div class="header">Pivoter</div>
<div id="start" class="page">
    <div class="msg">Waiting for story...</div>
</div>
<div id="vote" class="page">
    <div id="buttongrid">
        <div class="grid">
            <div class="button">0</div>
        </div>
        <div class="grid">
            <div class="button">1</div>
        </div>
        <div class="grid">
            <div class="button">2</div>
        </div>
        <div class="grid">
            <div class="button">3</div>
        </div>
        <div class="grid">
            <div class="button">5</div>
        </div>
        <div class="grid">
            <div class="button">8</div>
        </div>
        <div class="grid">
            <div class="button">13</div>
        </div>
        <div class="grid">
            <div class="button">21</div>
        </div>
        <div class="grid">
            <div class="button">34</div>
        </div>
        <div class="grid">
            <div class="button">55</div>
        </div>
        <div class="grid">
            <div class="button">?</div>
        </div>
        <div class="grid">
            <div class="button"><img src="coffe_cup.png" height="42" width="42" /></div>
        </div>
        <div style="clear:both"></div>
        <div class="footer"><span id="votes">0</span> of <span id="voters">1</span> votes in</div>
    </div>
</div>
</body>
</html>